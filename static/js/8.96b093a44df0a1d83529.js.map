{"version":3,"sources":["webpack:///src/views/photo1.vue","webpack:///./src/views/photo1.vue?dc51","webpack:///./src/views/photo1.vue"],"names":["tset","photo1","init","this","upload","applay","totalPage","list","pageNumber","click","projectId","re","views_photo1","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","header","hheader","slot","on","submintPhoto","_v","refresh","onRefresh","model","value","callback","$$v","isLoading","expression","finished","load","onLoad","loading","_l","v","src","address","alt","_s","photo_name","action","enctype","method","id","target","directives","name","rawName","type","domProps","input","$event","composing","ref","frameborder","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"mHAiCAA,cACAC,yCAMA,2BAEA,aACA,mBAEA,YACA,YACA,oCAIA,kDAGA,kBACAC,aACAC,mGAGAC,sDAGA,UACAC,WAEA,0CAKAF,uCAEA,eACA,YAEA,8BAIAA,wDAGA,qCAEA,+DAEAG,4CACAC,iBACA,IACAC,qDAEA,MAGA,mEAGAC,iCAGAN,+BACAO,yCAEA,YAEA,cACA,0HAMA,yBAEAA,6CAIA,4BAEA,cACA,kCAEA,eACA,IACAR,iDAKA,UACA,kBACA,4BAMAC,8BAEA,qCAEA,wDAEAQ,oBACAJ,wBACAD,oEAOAN,KCzJA,IAGAY,GADiBC,OAFjB,WAA0B,IAAAC,EAAAX,KAAaY,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,UAAoBF,EAAA,WAAgBG,OAAOC,OAAAP,EAAAQ,WAAsBL,EAAA,QAAaG,OAAOG,KAAA,UAAgBC,IAAKf,MAAAK,EAAAW,cAAyBF,KAAA,WAAeT,EAAAY,GAAA,YAAAZ,EAAAY,GAAA,KAAAT,EAAA,WAA+CE,YAAA,6CAAuDF,EAAA,oBAAyBO,IAAIG,QAAAb,EAAAc,WAAwBC,OAAQC,MAAAhB,EAAA,UAAAiB,SAAA,SAAAC,GAA+ClB,EAAAmB,UAAAD,GAAkBE,WAAA,eAAyBjB,EAAA,YAAiBG,OAAOe,SAAArB,EAAAqB,UAAwBX,IAAKY,KAAAtB,EAAAuB,QAAkBR,OAAQC,MAAAhB,EAAA,QAAAiB,SAAA,SAAAC,GAA6ClB,EAAAwB,QAAAN,GAAgBE,WAAA,aAAuBjB,EAAA,MAAWE,YAAA,YAAuBL,EAAAyB,GAAAzB,EAAA,iBAAA0B,GAAkC,OAAAvB,EAAA,MAAgBE,YAAA,eAAyBF,EAAA,OAAYE,YAAA,aAAuBF,EAAA,OAAYG,OAAOqB,IAAAD,EAAAE,QAAAC,IAAA,QAA0B7B,EAAAY,GAAA,KAAAT,EAAA,MAAAH,EAAAY,GAAAZ,EAAA8B,GAAAJ,EAAAK,oBAA0D/B,EAAAY,GAAA,KAAAT,EAAA,OAAyBE,YAAA,SAAAC,OAA4B0B,OAAA,0BAAAC,QAAA,sBAAAC,OAAA,OAAAC,GAAA,QAAAC,OAAA,YAAmHjC,EAAA,SAAckC,aAAaC,KAAA,QAAAC,QAAA,UAAAvB,MAAAhB,EAAA,UAAAoB,WAAA,cAA4Ed,OAASkC,KAAA,SAAAF,KAAA,aAAmCG,UAAWzB,MAAAhB,EAAA,WAAwBU,IAAKgC,MAAA,SAAAC,GAAyBA,EAAAP,OAAAQ,YAAsC5C,EAAAJ,UAAA+C,EAAAP,OAAApB,WAAoChB,EAAAY,GAAA,KAAAT,EAAA,cAA+BE,YAAA,OAAAC,OAA0BkC,KAAA,UAAAL,GAAA,qBAAyCnC,EAAAY,GAAA,kCAAAT,EAAA,SAAuD0C,IAAA,kBAAAvC,OAA6BkC,KAAA,OAAAF,KAAA,UAAAH,GAAA,kBAAiD,GAAAnC,EAAAY,GAAA,KAAAT,EAAA,UAAiCG,OAAOwC,YAAA,IAAAX,GAAA,SAAAG,KAAA,eAAiD,OAAAtC,EAAAY,GAAA,KAAAT,EAAA,gBAExoD4C,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACA/D,EACAW,GATA,EAVA,SAAAqD,GACAF,EAAA,SAaA,KAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"static/js/8.96b093a44df0a1d83529.js","sourcesContent":["<template>\r\n    <div class=\"photo\">\r\n        <hheader :header=\"hheader\">\r\n            <span slot=\"hright\" @click=\"submintPhoto\">上传图片</span>\r\n        </hheader>\r\n        <section class=\"container has-header has-gray has-footer\">\r\n            <van-pull-refresh v-model=\"isLoading\" @refresh=\"onRefresh\">\r\n                <van-list v-model=\"loading\" :finished=\"finished\" @load=\"onLoad\">\r\n                    <ul class=\"photo-ul\">\r\n                        <li class=\"photo-item\" v-for=\"v in imgList\">\r\n                            <div class=\"item-top\">\r\n                                <img :src=\"v.address\" alt=\"\">\r\n                            </div>\r\n                            <h4>{{v.photo_name}}</h4>\r\n                        </li>\r\n                    </ul>\r\n                    <div class=\"hhfrom\" action=\"/apis/project/uploadpic\" enctype=\"multipart/form-data\" method=\"post\" id=\"hform\" target=\"iframe\">\r\n                        <input type=\"hidden\" name=\"projectId\" v-model=\"projectId\">\r\n                        <van-button type=\"primary\" class=\"file\" id=\"imageFileParent\">上传照片\r\n                            <input type=\"file\" ref=\"referenceUpload\" name=\"imgFile\" id=\"imageFile\" style=\"\">\r\n                        </van-button>\r\n                        <!-- <button type=\"button\" @click=\"applay\">提交</button> -->\r\n                    </div>\r\n                    <iframe frameborder=\"0\" id=\"iframe\" name=\"iframe\"></iframe>\r\n                </van-list>\r\n            </van-pull-refresh>\r\n        </section>\r\n        <hfooter></hfooter>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nvar tset;\r\nimport { Toast } from \"vant\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            hheader: {\r\n                title: \"基坑监测项目\"\r\n            },\r\n            imgList: [],\r\n            count: 0,\r\n            isLoading: false,\r\n            list: [],\r\n            loading: false,\r\n            finished: false,\r\n            projectId: \"\",\r\n            pageNumber: 0, //当前页数\r\n            totalPage: 0, //总页数\r\n            upload: true\r\n        };\r\n    },\r\n    created() {\r\n        this.projectId = HGetHashUrl(\"projectId\");\r\n        this.init();\r\n        let self = this;\r\n        //创建定时器\r\n        tset = setInterval(function() {\r\n            console.log(\"文件值\" + self.$refs.referenceUpload.value+\"<<<<是否允许上传???>>>\"+self.upload);\r\n            //console.log(\"是否允许上传\" + self.upload);\r\n            if ($('#imageFile').val() && self.upload) {\r\n                console.log(\"触发上传\");\r\n                self.applay();\r\n            }\r\n        }, 100);\r\n    },\r\n    methods: {\r\n        //上拉刷新\r\n        onRefresh() {\r\n            let self = this;\r\n            setTimeout(() => {\r\n                self.totalPage = 0;\r\n                self.pageNumber = 0;\r\n                self.init(); //加载数据\r\n            }, 500);\r\n        },\r\n        //\r\n        onLoad() {\r\n            let self = this;\r\n            setTimeout(() => {\r\n                let data = {\r\n                    projectId: HGetHashUrl(\"projectId\"),\r\n                    pageNumber: self.pageNumber + 1\r\n                };\r\n                self.$.Get(\"/project/imgShow\", data, re => {\r\n                    self.totalPage = re.info.totalPage;\r\n                    self.imgList=self.imgList.concat(re.info.list);\r\n                    self.loading = false;\r\n                    self.pageNumber++;\r\n                    if (self.pageNumber >= self.totalPage) {\r\n                        self.finished = true;\r\n                    }\r\n                });\r\n            }, 500);\r\n        }, //提交\r\n        submintPhoto() {\r\n            document.getElementById(\"imageFile\").click();\r\n        },\r\n        applay() {\r\n            let self = this;\r\n            console.log(\"图片》》》》\" + self.projectId);\r\n            if (!$(\"#imageFile\").val()) {\r\n                return false;\r\n            }\r\n            self.upload = false;\r\n            console.log(\"上传图片\");\r\n            $.ajaxFileUpload({\r\n                //url: \"/apis/project/uploadpic?projectId=\" + self.projectId, //提交的路径\r\n                url: \"/project/uploadpic?projectId=\" + self.projectId, //提交的路径\r\n                secureuri: false, // 是否启用安全提交，默认为false\r\n                fileElementId: \"imageFile\", // file控件id\r\n                dataType: \"json\",\r\n                data: {\r\n                    projectId: self.projectId\r\n                    // fileName:$('#imageFile').val()\r\n                }, // 键:值，传递文件名\r\n                success: function(data, status) {\r\n                    Toast(\"上传成功\");\r\n                    //self.$refs.referenceUpload.value = \"\";\r\n                     $('#imageFile').val(\"\");\r\n                    self.upload = true;\r\n                    if (data.flag == \"success\") {\r\n                        self.totalPage = 0;\r\n                        self.pageNumber = 0;\r\n                        self.init();\r\n                    }\r\n                },\r\n                error: function(data, status) {\r\n                    //self.$refs.referenceUpload.value = \"\";\r\n                    $('#imageFile').val(\"\");\r\n                    alert(\"上传失败\");\r\n                    self.upload = true;\r\n                }\r\n            });\r\n        },\r\n        //获取图片\r\n        init() {\r\n            let self = this;\r\n            let data = {\r\n                projectId: HGetHashUrl(\"projectId\"),\r\n                pageNumber: self.pageNumber + 1\r\n            };\r\n            self.$.Get(\"/project/imgShow\", data, re => {\r\n                console.log(re);\r\n                self.imgList = re.info.list;\r\n                self.totalPage = re.info.totalPage;\r\n                // self.pageNumber++;\r\n                self.isLoading = false; //关闭下拉刷新效果\r\n            });\r\n        }\r\n    },\r\n    beforeDestroy() {\r\n        clearInterval(tset);\r\n    }\r\n};\r\nfunction uploadImg() {\r\n    console.log(\"图片》》》》\" + HGetHashUrl(\"projectId\"));\r\n    $.ajaxFileUpload({\r\n        url: \"/apis/project/uploadpic?projectId=\" + HGetHashUrl(\"projectId\"), //提交的路径\r\n        //url: \"/project/uploadpic?projectId=\" + self.projectId, //提交的路径\r\n        secureuri: false, // 是否启用安全提交，默认为false\r\n        fileElementId: \"imageFile\", // file控件id\r\n        dataType: \"json\",\r\n        data: {\r\n            projectId: HGetHashUrl(\"projectId\")\r\n            //projectId:0\r\n            // fileName:$('#imageFile').val()\r\n        }, // 键:值，传递文件名\r\n        success: function(data, status) {\r\n            console.log(data);\r\n            $(\"#imageFile\").val(\"\");\r\n            $(\"#imageFileParent\").html(\"\");\r\n            if (data.flag == \"success\") {\r\n                self.totalPage = 0;\r\n                self.pageNumber = 0;\r\n                self.init();\r\n            }\r\n            setTimeout(function() {\r\n                var html =\r\n                    '<input type=\"file\" name=\"imgFile\" id=\"imageFile\" @change=\"applay\" style=\"\">';\r\n                $(\"#imageFileParent\").html(html);\r\n            }, 8000);\r\n        },\r\n        error: function(data, status) {\r\n            alert(data.message);\r\n        }\r\n    });\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\">\r\n@import \"../assets/hcsy.scss\";\r\n.photo {\r\n    .hhfrom {\r\n        width: 100%;\r\n        clear: both;\r\n        text-align: center;\r\n        display: none;\r\n        .van-button {\r\n            height: rem(93);\r\n            line-height: rem(93);\r\n            margin: rem(50) auto;\r\n            overflow: hidden;\r\n        }\r\n        .file {\r\n            position: relative;\r\n            display: inline-block;\r\n            background: #28c189;\r\n            border: 0px solid #28c189;\r\n            border-radius: rem(8);\r\n            padding: rem(8) rem(24);\r\n            overflow: hidden;\r\n            color: white;\r\n            text-decoration: none;\r\n            text-indent: 0;\r\n            line-height: rem(40);\r\n        }\r\n        .file input {\r\n            position: absolute;\r\n            font-size: rem(200);\r\n            right: 0;\r\n            top: 0;\r\n            opacity: 0;\r\n        }\r\n    }\r\n    .photo-ul {\r\n        .photo-item {\r\n            width: rem(562);\r\n            height: rem(708);\r\n            font-size: rem(40);\r\n            text-align: center;\r\n            background-color: white;\r\n            float: left;\r\n            box-shadow: rem(2) rem(5) rem(20) rem(2) #d4d4d4;\r\n            margin: rem(40) 0 rem(40) rem(40);\r\n            .item-top {\r\n                height: rem(558);\r\n                position: relative;\r\n                > p {\r\n                    position: absolute;\r\n                    top: 0;\r\n                    left: 0;\r\n                    color: white;\r\n                    height: rem(45);\r\n                    line-height: rem(45);\r\n                    margin: rem(39);\r\n                    i {\r\n                        font-size: rem(45);\r\n                    }\r\n                }\r\n                img {\r\n                    width: 100%;\r\n                    height: 100%;\r\n                }\r\n            }\r\n            h4 {\r\n                margin: rem(35) 0;\r\n                font-weight: bold;\r\n            }\r\n            .van-button {\r\n                height: rem(93);\r\n                line-height: rem(93);\r\n                overflow: hidden;\r\n            }\r\n            .file {\r\n                position: relative;\r\n                display: inline-block;\r\n                background: #28c189;\r\n                border: 0px solid #28c189;\r\n                border-radius: rem(8);\r\n                padding: rem(8) rem(24);\r\n                overflow: hidden;\r\n                color: white;\r\n                text-decoration: none;\r\n                text-indent: 0;\r\n                line-height: rem(40);\r\n            }\r\n            .file input {\r\n                position: absolute;\r\n                font-size: rem(200);\r\n                right: 0;\r\n                top: 0;\r\n                opacity: 0;\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/photo1.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"photo\"},[_c('hheader',{attrs:{\"header\":_vm.hheader}},[_c('span',{attrs:{\"slot\":\"hright\"},on:{\"click\":_vm.submintPhoto},slot:\"hright\"},[_vm._v(\"上传图片\")])]),_vm._v(\" \"),_c('section',{staticClass:\"container has-header has-gray has-footer\"},[_c('van-pull-refresh',{on:{\"refresh\":_vm.onRefresh},model:{value:(_vm.isLoading),callback:function ($$v) {_vm.isLoading=$$v},expression:\"isLoading\"}},[_c('van-list',{attrs:{\"finished\":_vm.finished},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},[_c('ul',{staticClass:\"photo-ul\"},_vm._l((_vm.imgList),function(v){return _c('li',{staticClass:\"photo-item\"},[_c('div',{staticClass:\"item-top\"},[_c('img',{attrs:{\"src\":v.address,\"alt\":\"\"}})]),_vm._v(\" \"),_c('h4',[_vm._v(_vm._s(v.photo_name))])])})),_vm._v(\" \"),_c('div',{staticClass:\"hhfrom\",attrs:{\"action\":\"/apis/project/uploadpic\",\"enctype\":\"multipart/form-data\",\"method\":\"post\",\"id\":\"hform\",\"target\":\"iframe\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.projectId),expression:\"projectId\"}],attrs:{\"type\":\"hidden\",\"name\":\"projectId\"},domProps:{\"value\":(_vm.projectId)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.projectId=$event.target.value}}}),_vm._v(\" \"),_c('van-button',{staticClass:\"file\",attrs:{\"type\":\"primary\",\"id\":\"imageFileParent\"}},[_vm._v(\"上传照片\\n                        \"),_c('input',{ref:\"referenceUpload\",attrs:{\"type\":\"file\",\"name\":\"imgFile\",\"id\":\"imageFile\"}})])],1),_vm._v(\" \"),_c('iframe',{attrs:{\"frameborder\":\"0\",\"id\":\"iframe\",\"name\":\"iframe\"}})])],1)],1),_vm._v(\" \"),_c('hfooter')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4a31d32a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/photo1.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"importLoaders\\\":1,\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4a31d32a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./photo1.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./photo1.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./photo1.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4a31d32a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./photo1.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/photo1.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}